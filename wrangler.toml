# Cloudflare Worker Configuration for EDData Collector
# Optimized for free tier with advanced caching features

name = "eddata-api-gateway"
main = "worker.js"
compatibility_date = "2026-01-01"

# Workers.dev subdomain deployment
workers_dev = true

# Enable preview URLs for deployments
preview_urls = true

# Account Details (update with your values!)
# account_id = "YOUR_ACCOUNT_ID"  # Get from Cloudflare Dashboard
# workers_dev = true  # Enable for development on workers.dev subdomain

# Route configuration - handles /cache/* on api.eddata.dev
# This allows clients to continue using api.eddata.dev without changes
[[routes]]
pattern = "api.eddata.dev/cache/*"
zone_name = "eddata.dev"

# Environment Variables
[vars]
ENVIRONMENT = "production"
ORIGIN_URL = "https://api.eddata.dev"
VERSION = "1.0.0"
ENABLE_METRICS = "false"  # Set to "true" to enable /metrics endpoint

# Development Settings
[dev]
port = 8787
local_protocol = "http"

# Build Configuration
[build]
command = ""
watch_dirs = ["worker.js"]

# Observability (Cloudflare Analytics)
[observability]
enabled = true

# Limits (for reference - managed by Cloudflare)
# Free Tier: 
#   - 100,000 requests/day
#   - 10ms CPU time per request
#   - 1MB worker size
#   - Unlimited bandwidth for cached responses
